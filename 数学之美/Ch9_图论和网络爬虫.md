**目录**

1. 构建爬虫要点
2. 建立散列表

# 1. 构建爬虫要点
构建网络爬虫的几个**要点**：

1. **调度系统**：爬虫对网页遍历次序不是简单的BFS或者DFS，而是有一个相对复杂的下载优先级排序的子系统，即调度系统。系统里需要存储那些已经发现、但是尚未下载的网页url，它们一般被存在一个优先队列（PriorityQueue）里。
2. **页面分析和URL的提取**：当一个网页下载完之后，我们需要将其中的URL提取出来。但是现在很多网页的是由一些脚本生成的（比如JavaScript），所以打卡网页源码，URL不是直接可见的，需要运行一段脚本后才能得到。这时就需要模拟浏览器运行脚本，才能获得隐含的URL。
3. **散列表——记录已经下载过的网页**：为了防止一个网页被下载多次，我们需要记录已经下载过的网页。采用散列表的好处是：判断一个网页URL是否在表中，平均只需一次查找。

# 2. 建立散列表
多台机器建立、维护一张散列表并不容易，主要在于：

- 散列表大到一台机器存储不了
- 每台下载机器在下载前和下载后都要访问和维护这张表，存储散列表机器的通信就成了爬虫系统的瓶颈。

消除瓶颈可采取的措施：

- 明确每台下载机的分工。以免很多下载机的重复判断（某个URL是否需要下载）。
- 在明确分工基础上，判断URL是否下载可以进行批处理。即每次向散列表所在服务器发送一批询问，或者每次更新一批散列表内容。


